# PDF 全文结构识别还原系统 - 用户操作指南

## 快速开始

### 1. 启动系统

**Windows 用户**：双击 `run_dev_v3.bat` 启动

**手动启动**：
```bash
# 后端
cd backend
python app.py

# 前端（新终端）
cd frontend
npm run dev
```

### 2. 访问系统

打开浏览器访问：http://localhost:3000

---

## 界面说明

### 顶部状态栏

```
┌─────────────────────────────────────────────────────────────────┐
│  ① 模型启动 ─ ② 上传文件 ─ ③ 识别处理 ─ ④ 结果显示 ─ ⑤ 预录入 ─ ⑥ 确认  │
│     (✓)         (0.5s)       (处理中...)                              │
└─────────────────────────────────────────────────────────────────┘
```

- **绿色圆圈**：步骤已完成
- **蓝色脉冲**：当前进行中
- **黄色**：等待中
- **红色**：出错

### 服务状态指示器

```
┌────────────────────────────────────────┐
│ 🟢 OCR模型: PaddleOCR                  │
│ 🟢 LLM服务: gpt-oss:20b                │
│ 🟡 RAG服务: 未启用                      │
└────────────────────────────────────────┘
```

- 🟢 绿色：服务正常
- 🟡 黄色：服务可选/未启用
- 🔴 红色：服务离线

---

## 基础操作流程

### 步骤 1：上传文件

1. 点击上传区域或拖放文件
2. 支持格式：PDF、JPG、PNG
3. 最大文件大小：50MB

### 步骤 2：等待识别

- 系统自动进行 OCR 识别
- 进度条显示处理进度
- 通常需要 30-60 秒

### 步骤 3：查看结果

**左侧面板**：原始文档图像
- 蓝色框：识别区域
- 红色框：鼠标悬停
- 绿色框：选中状态
- 左上角数字：Block 序号

**右侧面板**：识别结果列表
- 每个 Block 显示类型标识
- TEXT（蓝色）：文本内容
- TABLE（紫色）：表格内容

### 步骤 4：编辑内容

**编辑文本**：
1. 双击左侧区域框或右侧 Block
2. 在弹出框中修改文本
3. 点击"保存"确认

**编辑表格**：
1. 双击表格类型的 Block
2. 直接点击单元格编辑
3. 点击"保存"确认

### 步骤 5：下载结果

| 按钮 | 说明 |
|------|------|
| 📄 原始文件 | 下载原始 PDF/图片 |
| 📊 置信度LOG | 置信度计算日志 |
| 📐 布局JSON | PPStructure 布局结果 |
| 📝 OCR结果 | OCR 原始 JSON |
| 🌐 HTML | HTML 格式输出 |
| 📝 MD | Markdown 格式输出 |

---

## 历史缓存功能

### 查看历史

右侧"历史缓存"面板显示最近处理的文件：
- 点击文件名：加载缓存结果
- 点击 🗑：删除缓存
- 点击 🔄：刷新列表

### 加载缓存

点击历史记录后：
- 跳过步骤 1-3
- 直接显示缓存结果
- 无需等待重新识别

---

## 智能功能（PP-ChatOCRv4）

### 智能信息提取

1. 处理完文档后，点击"智能提取"
2. 选择模板（发票、合同、身份证等）
3. 或自定义提取字段
4. 点击"开始提取"
5. 查看结构化提取结果

**预设模板**：
- 发票：发票号、金额、日期等
- 合同：甲方、乙方、金额等
- 身份证：姓名、身份证号等
- 简历：姓名、联系方式、经历等

### 文档问答

1. 点击"文档问答"
2. 输入问题（如"总金额是多少？"）
3. 点击"提问"
4. 查看 AI 回答和引用原文

---

## 快捷键

| 快捷键 | 功能 |
|--------|------|
| `Ctrl + S` | 下载 OCR 结果 |
| `Esc` | 关闭编辑弹窗 |

---

## 常见问题

### Q: 识别速度慢？

A: 首次启动需要加载模型（约 60 秒），后续处理会更快。

### Q: 表格识别不准确？

A: 尝试上传更清晰的图片，或调整 PDF 导出分辨率。

### Q: LLM 服务不可用？

A: 检查 Ollama 服务是否启动：
```bash
ollama serve
ollama run gpt-oss:20b
```

### Q: 中文乱码？

A: 系统已支持中文，如有问题请检查文件编码。

---

## 技术支持

- 查看 [README.md](../README.md) 了解技术架构
- 查看 [CHANGELOG.md](../CHANGELOG.md) 了解更新历史
- 查看 `temp/` 目录下的调试文件排查问题
